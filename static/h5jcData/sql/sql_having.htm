<link rel="stylesheet" type="text/css" href="../c3.css" />

<body class="html">
<div id="wrapper">
<div id="maincontent">

<h1>SQL HAVING 子句</h1>

<div  id="tpn">
<ul class="prenext">
<li class="pre"><a href="sql_groupby.htm"  title="SQL GROUP BY 语句">SQL Group By</a></li>
<li class="next"><a href="sql_func_ucase.htm"  title="SQL UCASE() 函数">SQL ucase()</a></li>
</ul>
</div>

<div>
<h2>HAVING 子句</h2>

<p>在 SQL 中增加 HAVING 子句原因是，WHERE 关键字无法与合计函数一起使用。</p>

<h3>SQL HAVING 语法</h3>

<pre>
SELECT column_name, aggregate_function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name
HAVING aggregate_function(column_name) operator value
</pre>
</div>

<div>
<h2>SQL HAVING 实例</h2>

<p>我们拥有下面这个 &quot;Orders&quot; 表：</p>

<table class="dataintable">
  <tr>
    <th>O_Id</th>
    <th>OrderDate</th>
    <th>OrderPrice</th>
    <th>Customer</th>
  </tr>
  <tr>
    <td>1</td>
    <td>2008/12/29</td>
    <td>1000</td>
    <td>Bush</td>
  </tr>
  <tr>
    <td>2</td>
    <td>2008/11/23</td>
    <td>1600</td>
    <td>Carter</td>
  </tr>
  <tr>
    <td>3</td>
    <td>2008/10/05</td>
    <td>700</td>
    <td>Bush</td>
  </tr>
  <tr>
    <td>4</td>
    <td>2008/09/28</td>
    <td>300</td>
    <td>Bush</td>
  </tr>
  <tr>
    <td>5</td>
    <td>2008/08/06</td>
    <td>2000</td>
    <td>Adams</td>
  </tr>
  <tr>
    <td>6</td>
    <td>2008/07/21</td>
    <td>100</td>
    <td>Carter</td>
  </tr>
</table>

<p>现在，我们希望查找订单总金额少于 2000 的客户。</p>

<p>我们使用如下 SQL 语句：</p>

<pre>
SELECT Customer,SUM(OrderPrice) FROM Orders
GROUP BY Customer
HAVING SUM(OrderPrice)&lt;2000
</pre>

<p>结果集类似：</p>

<table class="dataintable">
  <tr>
    <th>Customer</th>
    <th>SUM(OrderPrice)</th>
  </tr>
  <tr>
    <td>Carter</td>
    <td>1700</td>
  </tr>
</table>

<p>现在我们希望查找客户 &quot;Bush&quot; 或 &quot;Adams&quot; 拥有超过 1500 的订单总金额。</p>

<p>我们在 SQL 语句中增加了一个普通的 WHERE 子句：</p>

<pre>
SELECT Customer,SUM(OrderPrice) FROM Orders
WHERE Customer='Bush' OR Customer='Adams'
GROUP BY Customer
HAVING SUM(OrderPrice)&gt;1500
</pre>

<p>结果集：</p>

<table class="dataintable">
  <tr>
    <th>Customer</th>
    <th>SUM(OrderPrice)</th>
  </tr>
  <tr>
    <td>Bush</td>
    <td>2000</td>
  </tr>
  <tr>
    <td>Adams</td>
    <td>2000</td>
  </tr>
</table>
</div>

</div>
</div>
<script src="../chrX.js"></script>